DROP DATABASE IF EXISTS BankDB;
CREATE DATABASE BankDB;
USE BankDB;

CREATE TABLE Customer (
Account_no INT AUTO_INCREMENT PRIMARY KEY,
Name VARCHAR(50) NOT NULL,
Balance INT,
City VARCHAR(50)
);

CREATE TABLE Loan (
Loan_no INT AUTO_INCREMENT PRIMARY KEY,
Name VARCHAR(50),
Loan_Amount INT
);

INSERT INTO Customer (Name, Balance, City) VALUES
('Ram',10000,'Pune'),
('Ravi',25000,'Nasik'),
('Sachin',30000,'Mumbai');

INSERT INTO Loan (Name, Loan_Amount) VALUES
('Ram',10000),
('Ravi',50000),
('Dipak',40000);

CREATE VIEW Customer_View AS
SELECT Name, City, Balance FROM Customer;

CREATE VIEW High_Balance_View AS
SELECT Name, Balance FROM Customer WHERE Balance > 20000;

CREATE VIEW Nasik_HighBal_View AS
SELECT Name, Balance FROM Customer 
WHERE City='Nasik' AND Balance > 20000;

CREATE INDEX idx_customer_name ON Customer(Name);

CREATE INDEX idx_customer_account_name ON Customer(Account_no, Name);

SELECT * FROM Customer;
SELECT * FROM Loan;
SELECT * FROM Customer_View;
SELECT * FROM High_Balance_View;
SELECT * FROM Nasik_HighBal_View;

SELECT * FROM Customer WHERE City='Pune';
SELECT * FROM Customer WHERE Balance>20000;

UPDATE Customer SET Balance = Balance + 5000 WHERE Name='Ram';
SELECT * FROM Customer;

DELETE FROM Customer WHERE Name='Sachin';
SELECT * FROM Customer;

SELECT COUNT(*) AS Total_Customers FROM Customer;
SELECT MAX(Balance) AS Highest_Balance FROM Customer;
SELECT UPPER(Name) AS Customer_Name FROM Customer;
SELECT * FROM Customer ORDER BY Balance ASC;

SELECT * FROM Loan ORDER BY Loan_Amount DESC;

SELECT DISTINCT Name FROM Customer
UNION
SELECT DISTINCT Name FROM Loan;

SELECT DISTINCT c.Name
FROM Customer c
INNER JOIN Loan l ON c.Name = l.Name;

INSERT INTO Customer (Name, Balance, City)
VALUES ('Sachin', 30000, 'Mumbai');

SELECT DISTINCT c.Name
FROM Customer c
LEFT JOIN Loan l ON c.Name = l.Name
WHERE l.Name IS NULL;

CREATE VIEW Loan_Interest_20Y AS
SELECT Name, Loan_Amount, Loan_Amount * 0.08 * 20 AS Interest_20_Years
FROM Loan;

SELECT * FROM Loan_Interest_20Y;





